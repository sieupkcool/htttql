<div class="sidebar">
  <div class="user-info">
    <img
      src="https://i.pinimg.com/736x/8f/1c/a2/8f1ca2029e2efceebd22fa05cca423d7.jpg"
      class="rounded-circle"
      alt="Avatar"
    />
    <h5 id="sidebar-username"></h5>
    <div id="sidebar-role" class="role-label"></div>
    <div class="status">● Online</div>
  </div>
  <a href="/index">🏠 Trang chủ</a>
  <a href="/profile">👤 Thông tin cá nhân</a>
  <a href="#" id="sidebar-statistics-link" class="role-all">📊 Thống kê</a>
  <a href="/bomon" class="role-truongkhoa">📚 Bộ môn</a>
  <a href="/assignment" class="role-truongbomon">🤝 Phân công</a>
  <a href="/progress" class="role-truongbomon">✅ Duyệt công việc</a>
  <a href="/create_exam" class="role-truongbomon">📝 Tạo đề thi</a>
  <a href="/exam_list" class="role-truongbomon">📋 Quản lý đề thi</a>
  <a href="/question_list" class="role-truongbomon">❓ Quản lý câu hỏi</a>

  <a href="/assigned_tasks" class="role-giangvien"
    >📝 Công việc được phân công</a
  >
  <a href="/completion_stats" class="role-truongbomon role-truongkhoa"
    >📈 Tỷ lệ hoàn thành</a
  >
  <a href="/users" class="role-truongkhoa">👥 Quản lý giảng viên</a>
  <a href="/login" id="logout-link">🚪 Đăng xuất</a>
</div>
<script>
  const role = localStorage.getItem("role");
  const hovaten = localStorage.getItem("hovaten");

  // Ẩn/hiện menu theo role
  document.querySelectorAll(".sidebar a").forEach((a) => {
    if (
      (a.classList.contains("role-truongkhoa") && role !== "Trưởng khoa") ||
      (a.classList.contains("role-truongbomon") && role !== "Trưởng bộ môn") ||
      (a.classList.contains("role-giangvien") && role !== "Giảng viên")
    ) {
      a.style.display = "none";
    }
  });

  // Đăng xuất
  document.getElementById("logout-link").onclick = function () {
    localStorage.clear();
  };

  // Hiển thị họ tên nếu có
  if (hovaten) document.getElementById("sidebar-username").innerText = hovaten;
  // Hiển thị vai trò
  if (role) document.getElementById("sidebar-role").innerText = role;
  // Điều hướng "Thống kê" theo vai trò
  document.getElementById("sidebar-statistics-link").onclick = function (e) {
    e.preventDefault();
    if (role === "Trưởng bộ môn") {
      window.location.href = "/completion_stats";
    } else if (role === "Trưởng khoa") {
      window.location.href = "/statistics";
    } else {
      window.location.href = "/statistics";
    }
  };
</script>
